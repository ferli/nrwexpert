function w(o){const e={success:!1,zones:[],errors:[],warnings:[]};if(!o||o.trim().length===0)return e.errors.push("File CSV kosong"),e;const a=o.split(/\r?\n/);let u=0;const n=a[0].toLowerCase();(n.includes("nama")||n.includes("name")||n.includes("zone")||n.includes("dma"))&&(u=1,e.warnings.push("Header terdeteksi dan dilewati"));let t=0,s=0;for(let r=u;r<a.length;r++){const m=a[r].trim();if(m)try{const i=k(m);if(i.length<3){e.warnings.push(`Baris ${r+1}: Kolom tidak lengkap (min: Nama, SIV, Terjual)`),s++;continue}const g=i[0]||`DMA-${String(t+1).padStart(2,"0")}`,h=i[1],f=i[2],S=i[3]||"0",N=i[4]||"0",l=parseFloat(h),c=parseFloat(f),p=parseFloat(S),d=parseFloat(N);if(isNaN(l)||isNaN(c)){e.warnings.push(`Baris ${r+1}: SIV atau Volume Terjual bukan angka valid`),s++;continue}if(l<=0||c<=0){e.warnings.push(`Baris ${r+1}: SIV dan Volume Terjual harus > 0`),s++;continue}c>l&&e.warnings.push(`Baris ${r+1}: Volume Terjual (${c}) > SIV (${l}) - Data mencurigakan`),e.zones.push({id:`zone-import-${Date.now()}-${t}`,name:g.trim(),data:{systemInputVolume:l.toString(),billedMetered:c.toString(),numberOfCustomers:isNaN(p)?"0":p.toString(),pipeLengthKm:isNaN(d)?"0":d.toString(),averagePressure:"2.5",unbilledMetered:"0",unbilledUnmetered:"0",unauthorizedPct:"3",meterInaccuracyPct:"2"}}),t++}catch(i){e.warnings.push(`Baris ${r+1}: Error parsing - ${i.message}`),s++}}return t>0?e.success=!0:e.errors.push("Tidak ada data valid yang bisa diimport"),s>0&&e.warnings.push(`Total ${s} baris dilewati karena data tidak valid`),e}function k(o){const e=[];let a="",u=!1;for(let n=0;n<o.length;n++){const t=o[n],s=o[n+1];t==='"'?u&&s==='"'?(a+='"',n++):u=!u:t===","&&!u?(e.push(a.trim()),a=""):a+=t}return e.push(a.trim()),e}function V(){return`Nama Zona,SIV (m³/bln),Terjual (m³/bln),Jumlah Pelanggan,Panjang Pipa (km)
DMA-01 Melati,50000,35000,1200,15.5
DMA-02 Mawar,75000,48000,1800,22.3
DMA-03 Anggrek,42000,28000,950,12.8`}export{V as generateCSVTemplate,w as parseZoneCSV};
